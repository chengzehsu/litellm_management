name: Deploy to Zeabur

on:
  workflow_run:
    workflows: ["CI/CD Pipeline"]
    types:
      - completed
    branches:
      - main
      - master

jobs:
  deploy:
    name: Trigger Zeabur Deployment
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    
    steps:
      - name: Check CI/CD Status
        run: |
          echo "âœ… CI/CD Pipeline completed successfully"
          echo "ðŸš€ Ready to deploy to Zeabur"
      
      - name: Deployment Instructions
        run: |
          echo "## ðŸ“‹ Zeabur Auto-Deploy Setup" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "Zeabur will automatically deploy when:" >> $GITHUB_STEP_SUMMARY
          echo "1. âœ… Repository is connected in Zeabur" >> $GITHUB_STEP_SUMMARY
          echo "2. âœ… Auto-deploy is enabled in service settings" >> $GITHUB_STEP_SUMMARY
          echo "3. âœ… Code is pushed to main/master branch" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Setup Steps:" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "1. Go to [Zeabur Dashboard](https://zeabur.com)" >> $GITHUB_STEP_SUMMARY
          echo "2. Connect repository: \`chengzehsu/litellm_management\`" >> $GITHUB_STEP_SUMMARY
          echo "3. Enable auto-deploy for each service" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Services:" >> $GITHUB_STEP_SUMMARY
          echo "- **LiteLLM Proxy**: Root directory (\`/\`)" >> $GITHUB_STEP_SUMMARY
          echo "- **Langfuse**: \`langfuse/\` directory" >> $GITHUB_STEP_SUMMARY
      
      - name: Deployment Status
        run: |
          echo "âœ“ CI/CD validation passed"
          echo "ðŸ“¦ Zeabur will automatically deploy this commit"
          echo ""
          echo "If auto-deploy is enabled, deployment should start automatically."
          echo "Check Zeabur dashboard for deployment status."

